{% extends 'Admin/base.html' %}

{% block body %}

<div class="content">
    <div class="page-header">
       <div class="add-item d-flex">
          <div class="page-title">
             <h4>Customer List</h4>
             <h6>Manage your warehouse</h6>
          </div>
       </div>
       <ul class="table-top-head">
          <li>
             <a data-bs-toggle="tooltip" data-bs-placement="top" aria-label="Pdf" data-bs-original-title="Pdf"><img src="https://dreamspos.dreamstechnologies.com/html/template/assets/img/icons/pdf.svg" alt="img"></a>
          </li>
          <li>
             <a data-bs-toggle="tooltip" data-bs-placement="top" aria-label="Excel" data-bs-original-title="Excel"><img src="https://dreamspos.dreamstechnologies.com/html/template/assets/img/icons/excel.svg" alt="img"></a>
          </li>
          <li>
             <a data-bs-toggle="tooltip" data-bs-placement="top" aria-label="Print" data-bs-original-title="Print">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-printer feather-rotate-ccw">
                   <polyline points="6 9 6 2 18 2 18 9"></polyline>
                   <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                   <rect x="6" y="14" width="12" height="8"></rect>
                </svg>
             </a>
          </li>
          <li>
             <a data-bs-toggle="tooltip" data-bs-placement="top" aria-label="Refresh" data-bs-original-title="Refresh">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rotate-ccw">
                   <polyline points="1 4 1 10 7 10"></polyline>
                   <path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path>
                </svg>
             </a>
          </li>
          <li>
             <a data-bs-toggle="tooltip" data-bs-placement="top" id="collapse-header" aria-label="Collapse" data-bs-original-title="Collapse">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-up">
                   <polyline points="18 15 12 9 6 15"></polyline>
                </svg>
             </a>
          </li>
       </ul>
       <div class="page-btn">
          <a href="#" class="btn btn-added" data-bs-toggle="modal" data-bs-target="#add-units">
             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus-circle me-2">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="16"></line>
                <line x1="8" y1="12" x2="16" y2="12"></line>
             </svg>
             Add New Customer
          </a>
       </div>
    </div>
    <!-- /product list -->
    <div class="card table-list-card">
       <div class="card-body">
          <div class="table-top">
             <div class="search-set">
                <div class="search-input">
                   <a href="" class="btn btn-searchset">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
                         <circle cx="11" cy="11" r="8"></circle>
                         <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                      </svg>
                   </a>
                   <div id="DataTables_Table_0_filter" class="dataTables_filter"><label> <input type="search" class="form-control form-control-sm" placeholder="Search" aria-controls="DataTables_Table_0"></label></div>
                </div>
             </div>
             <div class="search-path">
                <div class="d-flex align-items-center">
                   <a class="btn btn-filter" id="filter_search">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-filter filter-icon">
                         <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                      </svg>
                      <span><img src="https://dreamspos.dreamstechnologies.com/html/template/assets/img/icons/closes.svg" alt="img"></span>
                   </a>
                </div>
             </div>
             <div class="form-sort">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sliders info-img">
                   <line x1="4" y1="21" x2="4" y2="14"></line>
                   <line x1="4" y1="10" x2="4" y2="3"></line>
                   <line x1="12" y1="21" x2="12" y2="12"></line>
                   <line x1="12" y1="8" x2="12" y2="3"></line>
                   <line x1="20" y1="21" x2="20" y2="16"></line>
                   <line x1="20" y1="12" x2="20" y2="3"></line>
                   <line x1="1" y1="14" x2="7" y2="14"></line>
                   <line x1="9" y1="8" x2="15" y2="8"></line>
                   <line x1="17" y1="16" x2="23" y2="16"></line>
                </svg>
                <select class="select select2-hidden-accessible" data-select2-id="select2-data-1-p0fg" tabindex="-1" aria-hidden="true">
                   <option data-select2-id="select2-data-3-pyxs">Sort by Date</option>
                   <option>Newest</option>
                   <option>Oldest</option>
                </select>
                <!-- <span class="select2 select2-container select2-container--default" dir="ltr" data-select2-id="select2-data-2-zcnz" style="width: 100%;"><span class="selection"><span class="select2-selection select2-selection--single" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-disabled="false" aria-labelledby="select2-p8p2-container" aria-controls="select2-p8p2-container"><span class="select2-selection__rendered" id="select2-p8p2-container" role="textbox" aria-readonly="true" title="Sort by Date">Sort by Date</span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span></span></span><span class="dropdown-wrapper" aria-hidden="true"></span></span> -->
             </div>
          </div>
          <!-- /Filter -->
          <div class="card" id="filter_inputs">
             <div class="card-body pb-0">
                <div class="row">
                   <div class="col-lg-3 col-sm-6 col-12">
                      <div class="input-blocks">
                         <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-user info-img">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                         </svg>
                         <select class="select select2-hidden-accessible" data-select2-id="select2-data-4-rf5f" tabindex="-1" aria-hidden="true">
                            <option data-select2-id="select2-data-6-24bp">Choose Customer Name</option>
                            <option>Benjamin</option>
                            <option>Ellen</option>
                            <option>Freda</option>
                            <option>Kaitlin</option>
                         </select>
                         <span class="select2 select2-container select2-container--default" dir="ltr" data-select2-id="select2-data-5-pi6a" style="width: 100%;"><span class="selection"><span class="select2-selection select2-selection--single" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-disabled="false" aria-labelledby="select2-9mos-container" aria-controls="select2-9mos-container"><span class="select2-selection__rendered" id="select2-9mos-container" role="textbox" aria-readonly="true" title="Choose Customer Name">Choose Customer Name</span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span></span></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>
                      </div>
                   </div>
                   <div class="col-lg-3 col-sm-6 col-12">
                      <div class="input-blocks">
                         <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-globe info-img">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="2" y1="12" x2="22" y2="12"></line>
                            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                         </svg>
                         <select class="select select2-hidden-accessible" data-select2-id="select2-data-7-uuzu" tabindex="-1" aria-hidden="true">
                            <option data-select2-id="select2-data-9-rs25">Choose Country</option>
                            <option>India</option>
                            <option>USA</option>
                         </select>
                         <span class="select2 select2-container select2-container--default" dir="ltr" data-select2-id="select2-data-8-etlf" style="width: 100%;"><span class="selection"><span class="select2-selection select2-selection--single" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-disabled="false" aria-labelledby="select2-easl-container" aria-controls="select2-easl-container"><span class="select2-selection__rendered" id="select2-easl-container" role="textbox" aria-readonly="true" title="Choose Country">Choose Country</span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span></span></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>
                      </div>
                   </div>
                   <div class="col-lg-3 col-sm-6 col-12 ms-auto">
                      <div class="input-blocks">
                         <a class="btn btn-filters ms-auto">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
                               <circle cx="11" cy="11" r="8"></circle>
                               <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                            </svg>
                            Search 
                         </a>
                      </div>
                   </div>
                </div>
             </div>
          </div>
          <!-- /Filter -->
          <div class="table-responsive">
             <div id="DataTables_Table_0_wrapper" class="dataTables_wrapper dt-bootstrap5 no-footer table-responsive">
                <table class="table datanew dataTable no-footer"  aria-describedby="DataTables_Table_0_info">
                   <thead>
                      <tr>
                        <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Customer  Name: activate to sort column ascending" style="width: 241px;">
                            ID
                        </th>
                        <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Customer  Name: activate to sort column ascending" style="width: 241px;">
                            Name
                        </th>
                         <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Email: activate to sort column ascending" style="width: 251.547px;">
                            Email
                        </th>
                        <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Phone: activate to sort column ascending" style="width: 154.719px;">
                            Phone
                        </th>
                        <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Phone: activate to sort column ascending" style="width: 154.719px;">
                            NID
                        </th>
                         <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Country: activate to sort column ascending" style="width: 104.969px;">
                            Address
                        </th>
                        <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Country: activate to sort column ascending" style="width: 104.969px;">
                            Create Date
                        </th>
                         <th class="no-sort sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Action: activate to sort column ascending" style="width: 172.078px;">
                            Action
                        </th>
                      </tr>
                   </thead>
                   <tbody>
                    {% for customer in customers %}
                      <tr class="odd" id="table{{customer.id}}">
                         <td class="customer_id">
                            #{{customer.id}}
                         </td>
                         <td class="customer_name">{{customer.name}}</td>
                         <td class="customer_email">
                            {% if customer.email %}
                                {{customer.email}} 
                            {% else %}
                                --
                            {% endif %}
                         </td>
                         <td class="customer_number">{{customer.number}} </td>
                         <td class="customer_nid">
                            {% if customer.nid %}
                                {{customer.nid}} 
                            {% else %}
                                --
                            {% endif %}
                         </td>
                         <td class="customer_address">{{customer.address}}</td>
                         <td>{{customer.date_created|date:"d M Y"}}</td>
                         <td class="action-table-data">
                            <div class="edit-delete-action">
                               
                               <a class="me-2 p-2 customer_edit_btn" href="#" data-bs-toggle="modal" data-bs-target="#edit-units" >
                                    <input type="hidden" value="{{customer.id}}">
                                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit">
                                     <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                     <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                  </svg>
                               </a>
                               <a class="confirm-text p-2" href="javascript:void(0);">
                                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-trash-2">
                                     <polyline points="3 6 5 6 21 6"></polyline>
                                     <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                     <line x1="10" y1="11" x2="10" y2="17"></line>
                                     <line x1="14" y1="11" x2="14" y2="17"></line>
                                  </svg>
                               </a>
                            </div>
                         </td>
                      </tr>
                    {% endfor %}
                    
                   </tbody>
                </table>
                <!-- <div class="dataTables_length" id="DataTables_Table_0_length"><label><select name="DataTables_Table_0_length" aria-controls="DataTables_Table_0" class="form-select form-select-sm"><option value="10">10</option><option value="25">25</option><option value="50">50</option><option value="100">100</option></select></label></div><div class="dataTables_paginate paging_simple_numbers" id="DataTables_Table_0_paginate"><ul class="pagination"><li class="paginate_button page-item previous disabled" id="DataTables_Table_0_previous"><a aria-controls="DataTables_Table_0" aria-disabled="true" role="link" data-dt-idx="previous" tabindex="-1" class="page-link"><i class="fa fa-angle-left"></i> </a></li><li class="paginate_button page-item active"><a href="#" aria-controls="DataTables_Table_0" role="link" aria-current="page" data-dt-idx="0" tabindex="0" class="page-link">1</a></li><li class="paginate_button page-item next disabled" id="DataTables_Table_0_next"><a aria-controls="DataTables_Table_0" aria-disabled="true" role="link" data-dt-idx="next" tabindex="-1" class="page-link"> <i class=" fa fa-angle-right"></i></a></li></ul></div><div class="dataTables_info" id="DataTables_Table_0_info" role="status" aria-live="polite">1 - 10 of 10 items</div></div> -->
             </div>
          </div>
       </div>
       <!-- /product list -->
    </div>
    

{% endblock %}

{% block model %}
<!-- add customer model  -->
<div class="modal fade" id="add-units" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-dialog-centered custom-modal-two">
        <div class="modal-content" data-select2-id="select2-data-26-xqcn">
            <div class="page-wrapper-new p-0" data-select2-id="select2-data-25-rcls">
                <div class="content" data-select2-id="select2-data-24-1t7r">
                    <div class="modal-header border-0 custom-modal-header">
                        <div class="page-title">
                            <h4>Add Customer</h4>
                        </div>
                        <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="modal-body custom-modal-body" data-select2-id="select2-data-23-7j80">
                        <form id="form-add" action="{% url 'customer-list' %}" data-select2-id="select2-data-22-3a2a">{% csrf_token %}
                            <div class="row">
                                <div class="col-lg-6 pe-0">
                                    <div class="mb-3">
                                        <label class="form-label">Customer Name</label>
                                        <input name="name" type="text" class="form-control" placeholder="Enter full name">
                                    </div>
                                </div>
                                <div class="col-lg-6 pe-0">
                                    <div class="mb-3">
                                        <label class="form-label">Customer Email</label>
                                        <input name="email" type="email" class="form-control" placeholder="Enter valid email address">
                                    </div>
                                </div>
                                <div class="col-lg-6 pe-0">
                                    <div class="mb-3">
                                        <label class="form-label">Customer Number</label>
                                        <input name="number" type="text" class="form-control" placeholder="Enter a Phone number">
                                    </div>
                                </div>
                                <div class="col-lg-6 pe-0">
                                    <div class="mb-3">
                                        <label class="form-label">Customer NID</label>
                                        <input name="nid" type="text" class="form-control" placeholder="Enter current address">
                                    </div>
                                </div>	
                                <div class="col-lg-12 pe-0">
                                    <div class="mb-3">
                                        <label class="form-label">Customer Address</label>
                                        <input name="address" type="text" class="form-control" placeholder="Enter current address">
                                    </div>
                                </div>
                                				
                            </div>								
                            
                            <div class="modal-footer-btn">
                                <button type="button" class="btn btn-cancel me-2" data-bs-dismiss="modal">Cancel</button>
                                <button type="submit" class="btn btn-submit">Submit</button>
                            </div>
                        </form>
                    
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- edit customer model  -->
<div class="modal fade" id="edit-units" style="display: none;" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered custom-modal-two">
        <div class="modal-content">
            <div class="page-wrapper-new p-0">
                <div class="content">
                    <div class="modal-header border-0 custom-modal-header">
                        <div class="page-title">
                            <h4>Edit Customer</h4>
                        </div>
                        <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">×</span>
                        </button>
                    </div>
                    <div class="modal-body custom-modal-body">
                        <form id="form-edit" action="{% url 'customer-list' %}" data-select2-id="select2-data-22-3a2a" method="put">{% csrf_token %}
                            <input type="hidden" name="id">
                            <div class="row">
                                <div class="col-lg-6 pe-0">
                                    <div class="mb-3">
                                        <label class="form-label">Customer Name</label>
                                        <input name="name" type="text" class="form-control" placeholder="Enter full name">
                                    </div>
                                </div>
                                <div class="col-lg-6 pe-0">
                                    <div class="mb-3">
                                        <label class="form-label">Customer Email</label>
                                        <input name="email" type="email" class="form-control" placeholder="Enter valid email address">
                                    </div>
                                </div>
                                <div class="col-lg-6 pe-0">
                                    <div class="mb-3">
                                        <label class="form-label">Customer Number</label>
                                        <input name="number" type="text" class="form-control" placeholder="Enter a Phone number">
                                    </div>
                                </div>
                                <div class="col-lg-6 pe-0">
                                    <div class="mb-3">
                                        <label class="form-label">Customer NID</label>
                                        <input name="nid" type="text" class="form-control" placeholder="Enter current address">
                                    </div>
                                </div>	
                                <div class="col-lg-12 pe-0">
                                    <div class="mb-3">
                                        <label class="form-label">Customer Address</label>
                                        <input name="address" type="text" class="form-control" placeholder="Enter current address">
                                    </div>
                                </div>
                                				
                            </div>								
                            
                            <div class="modal-footer-btn">
                                <button type="button" class="btn btn-cancel me-2" data-bs-dismiss="modal">Cancel</button>
                                <button type="submit" class="btn btn-submit">Submit</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block script %}
<script>
    let edit_form = document.querySelector('form#form-edit');
    let add_form = document.querySelector('form#form-add');


    document.querySelectorAll("a.customer_edit_btn").forEach( click_event => {
        click_event.addEventListener("click", (event) =>{
            event.preventDefault();
            
            let tableid = event.target.parentNode.querySelector("input").value;
            let parent = document.querySelector("tr#table"+tableid);

            let id = parent.querySelector("td.customer_id");
            let name = parent.querySelector("td.customer_name");
            let email = parent.querySelector("td.customer_email");
            let number = parent.querySelector("td.customer_number");
            let address = parent.querySelector("td.customer_address");
            let nid = parent.querySelector("td.customer_nid");
    
            let id_field = edit_form.querySelector("input[name=id]");
            let name_field = edit_form.querySelector("input[name=name]");
            let email_field = edit_form.querySelector("input[name=email]");
            let number_field = edit_form.querySelector("input[name=number]");
            let address_field = edit_form.querySelector("input[name=address]");
            let nid_field = edit_form.querySelector("input[name=nid]");
    
            id_field.value = id.textContent;
            name_field.value = name.textContent;
            number_field.value = number.textContent;
            address_field.value = address.textContent;
            if(email.textContent.trim() != "--"){

                email_field.value = email.textContent.trim();
            }else{
                email_field.value = "";
            }
            if(nid.textContent.trim() != "--"){
                nid_field.value = nid.textContent.trim();
            }else{
                nid_field.value = "";
            }

            event.target.parentNode.click();
        });
    })

</script>

{% endblock %} 